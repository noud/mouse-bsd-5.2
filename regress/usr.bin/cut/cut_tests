#!/bin/sh

CUT=${CUT:-cut}

run_cut (){
    echo "----- test: cut $@ -----"
    ${CUT} "$@"
}

run_test_block (){
    run_cut -f 1 "$@"
    run_cut -f 2 "$@"
    run_cut -f 3 "$@"
    run_cut -f 1-2 "$@"
    run_cut -f 2,3 "$@"
    run_cut -f 4 "$@"
    run_cut -f 1-3,4-7 "$@"
    run_cut -f 1,2-7 "$@"
}

run_general_tests (){
    run_test_block "$@"
    run_test_block -s "$@"
    run_test_block -d ':' "$@"
    run_test_block -d ':' -s "$@"
}

run_locale_tests (){
    run_cut -b 6,7,8 "$@"
    run_cut -c 6,7,8 "$@"
}


run_general_tests $1/input-general | sed -e "s@$1/@@" > result-general
cmp result-general $1/expected-general

export LC_ALL=C
run_locale_tests $1/input-latin1 | sed -e "s@$1/@@" > result-latin1
cmp result-latin1 $1/expected-latin1

export LC_ALL=en_US.UTF-8
run_locale_tests $1/input-utf8 | sed -e "s@$1/@@" > result-utf8
cmp result-utf8 $1/expected-utf8

